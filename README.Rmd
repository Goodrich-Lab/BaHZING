---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# BaHZING: Bayesian Hierarchical Zero-Inflated Negative Binomial Regression with G-Computation

<!-- badges: start -->
[![Codecov test coverage](https://codecov.io/gh/Goodrich-Lab/BaHZING/branch/main/graph/badge.svg)](https://app.codecov.io/gh/Goodrich-Lab/BaHZING?branch=main)
<!-- badges: end -->


## Contents

- [Overview](#overview)
- [Installation](#overview)
- [Example](#example)



## Overview

This platform is dedicated to the analysis of environmental mixture exposures and other mixture exposures with hierarchical gut microbiome outcome data. BaZING, short for Bayesian Hierarchical Zero-Inflated Negative Binomial Regression with G-Computation, is a powerful toolkit designed to uncover intricate relationships between environmental exposures and gut microbiome outcomes.


## Installation

You can install the development version of BaHZING from [GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("Goodrich-Lab/BaHZING")
```

## Input Requirements
BaHZING's formatting function requires a phyloseq object as the input. Ensure that your phyloseq object adheres to the required format. Refer to the phyloseq documentation for details on creating and manipulating phyloseq objects. 
For covariates in phyloseq object: All categorical covariates must be formatted as binary indicator variables rather than categorical or factor variables. 
For missing data: Ensure that there are no NA values in your data, perform the necessary filtering or imputation methods necessary to handle these values as BaHZING cannot function with missing data. 

## Output
The formatting function produces an object that contains a table with all exposure variables, all covariates and the lowest level of microbiome outcome data. Additionally, the function produces binary matrices that represent the relationship between each level of microbiome data and the level above it.

The BaHZING model function provides results from the Bayesian hierarchical zero-inflated negative binomial regression model.

## Example
For a quick start, we utilize data from the iHMP publicly available data set. This example will guide you through the process of using BaZING for analyzing environmental mixture exposures with hierarchical gut microbiome outcome data.


```{r example}
library(BaHZING)

### Load example data
data("iHMP_Reduced")

### Format microbiome data
formatted_data <- Format_BaHZING(iHMP_Reduced)

### Perform Bayesian hierarchical zero-inflated negative binomial regression with g-computation
### Specify a mixture of exposures
x <- c("soft_drinks_dietnum","diet_soft_drinks_dietnum","fruit_juice_dietnum","water_dietnum",
       "alcohol_dietnum","yogurt_dietnum","dairy_dietnum","probiotic_dietnum","fruits_no_juice_dietnum",
       "vegetables_dietnum","beans_soy_dietnum","whole_grains_dietnum","starch_dietnum","eggs_dietnum",
       "processed_meat_dietnum","red_meat_dietnum","white_meat_dietnum","shellfish_dietnum","fish_dietnum",
       "sweets_dietnum")

### Specify a set of covariates
covar <- c("consent_age","sex",paste0("race",0:3),paste0("educ",0:7))

###Set exposure standaridization to standard_normal or quantiles
exposure_standardization = "standard_normal"

### Perform BaH-ZING 
results <- BaHZING_Model(formatted_data,covar,x,exposure_standardization)
```




<!-- delete information below this line before final submission -->


You'll still need to render `README.Rmd` regularly, to keep `README.md` up-to-date. `devtools::build_readme()` is handy for this.

You can also embed plots, for example:

```{r pressure, echo = FALSE}
# plot(pressure)
```

In that case, don't forget to commit and push the resulting figure files, so they display on GitHub and CRAN.
